# Brain_Trainer         

Shared Preferences 
Тренажер для мозга   

	Рассмотрение одного из вариантов принципа работы Shared Preferences    


Оформление экрана активности, добавление ссылок в код и присвоим им значение в методе onCreate  
Работа с методом private void generateQuestion(), который будет генерировать вопрос , этот метод нужен только в этом классе, поэтому private  
-получение двух случайных чисел, через статический метод .random() из класса Math,  (max - min + 1) + min) –> в необходимом диапазоне; 
-случайным образом устанавливается значение знака, положительное или отрицательное, для этого создается переменная типа int, присваивается приводя к типу int , умножается на два -> таким образом получаем число либо 0, либо 1, переменной isPositive присваиваем это значение ==1 . 
Если условие выполняется, тогда переменная isPositive будет true и знак будет +, если будет равен 0, то значение fools и знак "-";   
-циклом if генерируется правильный ответ; 
-формирование вопроса, если знак положительный, тогда question = String.format("%s+%s", a, b);  
-генерация индекса правильного ответа rightAnswerPosition, умножение на 4 так как нудно число от 0 до 3 включительно;    

Работа с методом private int generateWrongAnswer(), который генерирует неправильный ответ и возвращает результат
-что бы случайно генерируемое число не совпало с правильным ответом делается цикл do-while и возвращаем результат; 
-методы готовы;
-для проверки работы методов: 
--так как тест устанавливается в цикле, они заносятся в массив; 
-генерируется вопрос generateQuestion(), в цикле установлю значение вариантом: 
--пробегаю по всем textView и смотрю позицию;
--если позиция не равна правильному числу, то устанавливаю случайное значение; 
--если i будет совпадает с номером правильного, то устанавливаю правильный ответ; 
-в методе private void generateQuestion() устанавливаю текст и в качестве параметра передаю вопрос;    
Редактирую приложение так, чтобы каждый раз при выборе варианта генерировался новый вопрос 
-при клике необходимо повторить:
-генерируется вопрос generateQuestion(), в цикле установлю значение вариантом: 
--пробегаю по всем textView и смотрю позицию;
--если позиция не равна правильному числу, то устанавливаю случайное значение; 
--если i будет совпадает с номером правильного, то устанавливаю правильный ответ; 
-для этого новый метод  private void playNext();
-этот метод нужно будет вызывать при создании новой игры и при клике на кнопку; 
Вывод toast при клике на вариант ответа      

Что бы это сделать, нудно у textView, на который нажали, вызвать метод getText, но у параметра мы принимаем (автоматически) не textView, а просто View view, для того что бы из этого получить textView нужно сделать d , т.е. вывести к дочернему типу;   

Теперь получаем ответ и привожу его к типу string;    

Для того что бы сравнить правильный ответ с полученным нужно что бы их типы совпадали;     
Редактирую метод public void onClickAnswer(View view), что бы он не просто выводил toas, но и выводил количество очков в случае верных ответов и общее число вопросов ; 


Теперь устанавливаю текст у textViewScore в соответствии с результатом, это делаю и при клике на новый ответ и в методе onCreate – поэтому занесу в метод playNext;    

Добавляю таймер CountDownTimer timer = new CountDownTimer(), что бы пользователь набирал очки за какое-то время;   

Создаю метод private String getTimer(long millis), в котором миллисекунды будут преобразовываться в нормальный формат и возвращать его в виде строки, в качестве параметра он будет принимать количество миллисекунд;     

В CountDownTimer timer = new CountDownTimer(устанавливаю количество секунд, и тикать он будет пусть каждую секунду);   


Что бы по истечению оставшегося времени millisUntilFinished (сколько осталось миллисекунд) создаю переменную типа private boolean gameOver – которая будет хранить значение “закончилась ли игра”;   


Реагирование onClick по истечению timer 


В public void onClickAnswer(View view)  добавляю реагирование на нажатие только в том случае, если игра не закончена (время решения примера данной задачи), оборачиваю в if (!gameOver);    

В случае, если игра окончена, выводится результат и кнопка “начать игру сначала” для этого:   

-создаю новую активность ScoreActivity; 
-оформляю его activity_score.xml:
--добавляю текст; 
--добавляю кнопку и к ней атрибут onClick; 
-создаю метод public void onClickStartNewGame(View view) в ScoreActivity;  

Что бы запустить данную активность ScoreActivity создаю Intent в MainActivity:   
-так в данном случае CountDownTimer анонимный класс, то я не могу просто указать this, нужно явно указать в какой активности находимся (MainActivity.this ….) ;    
-что бы вторая активность могла отобразить результат кладем в intent (ключ – значение);   
-запускаем активность;     
Теперь в активности ScoreActivity    

-получаем Intent и проверяем;     
-устанавливаю очки в его activity_score.xml в textViewResult;      
-устанавливаю текст textView;     

В активности ScoreActivity    

-заменила текст button;   
-в методе public void onClickStartNewGame(View view), который будет вызываться при клике на кнопку, запускаю первую активность через Intent;    
-перехожу в первую активность  MainActivity:   
-теперь, когда timer завершается нужно получить   SharedPreferences;   
(так как в анонимном классе, не могу указать this, в данном случае this будет относится к нему, а не к активности, поэтому в качестве контекста передаю getApplicationContext())  
-добавила строку максимального результата, через   SharedPreferences;   

-теперь проверяю не сохранился ли уже результат максимального значения через int max = preferences.getInt("max",0);    
-и проверяю через if;    


В активности ScoreActivity    
-добавляю SharedPreferences;    
Редактирование timer  

Увеличила оставшееся время и если на игру осталось меньше определенного, то timer меняет свой цвет через MainActivity        


 





